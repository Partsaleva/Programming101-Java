package monday.bulkThumbnailCreator;

import java.awt.Graphics2D;

import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.Iterator;

import javax.imageio.ImageIO;

public class ImgResizer {
	public static void main(String[] args) {
		Path p=Paths.get("/home/partsaleva/Documents/img.jpg");
		//createThumbnailsDirectory(p);
		try {
			File f=resize(p,150,150);
			moveFile(f);
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		//resizeAndStore(p, 150,150);

	}
	// /home/partsaleva/Documents/img.jpg
	
	private static File resize(Path path, int width,int height) throws IOException{
		BufferedImage original=ImageIO.read(new File(path.toString()));
		int type = original.getType() == 0 ? BufferedImage.TYPE_INT_ARGB : original.getType();
		
		BufferedImage resized = new BufferedImage(width, height, type);
		Graphics2D g = resized.createGraphics();
		g.drawImage(original, 0, 0, width, height, null);
		g.dispose();
		File f=new File("/home/partsaleva/Documents/thumbnails/img_rezised.jpg");
		//ImageIO.write(resized, "jpg", f);	
		return f;
	}
	
	private static String createThumbnailsDirectory(Path path){			
			Path parent = path.getParent();		
			String result = parent+ "/thumbnails";
			
			new File(result).mkdirs();
			return result;
	}	
	
	private static void moveFile(File file){
		//File file=path.toFile();
		String p=file.getParent();
		String[] fileName=file.getName().split("\\.");
		System.out.println(p+fileName[0]+"_resized."+fileName[1]);
		for (int i = 0; i < fileName.length; i++) {
			System.out.println(fileName[i]);
			
		}
	}
	 public static void resizeAndStore(Path src, int width,int height){
		Thread tr1=new Thread(new Runnable() {
			
			@Override
			public void run() {
				try {
					resize(src, width,height);
				} catch (IOException e) {
					e.printStackTrace();
				}
				
			}
		});
		Thread tr2=new Thread(new Runnable() {
			
			@Override
			public void run() {
				createThumbnailsDirectory(src);				
			}
		});
		
		
	}
}
