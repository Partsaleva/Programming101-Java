package monday.bulkThumbnailCreator;

import java.awt.Graphics2D;

import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.Iterator;

import javax.imageio.ImageIO;

public class ImgResizer {
	public static void main(String[] args) {
		Path p=Paths.get("/home/partsaleva/Documents/img.jpg");
		//createThumbnailsDirectory(p);
		try {
			resize(p,150,150);
			
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		//resizeAndStore(p, 150,150);

	}
	// /home/partsaleva/Documents/img.jpg
	
	private static void resize(Path path, int width,int height) throws IOException{
		BufferedImage original=ImageIO.read(new File(path.toString()));
		int type = original.getType() == 0 ? BufferedImage.TYPE_INT_ARGB : original.getType();
		
		BufferedImage resized = new BufferedImage(width, height, type);
		Graphics2D g = resized.createGraphics();
		g.drawImage(original, 0, 0, width, height, null);
		g.dispose();
		File f=moveFile(path);
		ImageIO.write(resized, "jpg", f);	
		//return f;
	}
	
	private static String createThumbnailsDirectory(Path path){			
			Path parent = path.getParent();		
			String result = parent+ "/thumbnails";
			
			new File(result).mkdirs();
			return result;
	}	
	
	private static File moveFile(Path path){
		File file=path.toFile();
		String p=file.getParent();
		String[] fileName=file.getName().split("\\.");
		return new File(p+"/"+fileName[0]+"_resized."+fileName[1]);
	
	}
	 public static void resizeAndStore(Path src, int width,int height){
		Thread tr1=new Thread(new Runnable() {
			
			@Override
			public void run() {
				try {
					resize(src, width,height);
				} catch (IOException e) {
					e.printStackTrace();
				}
				
			}
		});
		Thread tr2=new Thread(new Runnable() {
			
			@Override
			public void run() {
				createThumbnailsDirectory(src);				
			}
		});
		
		
	}
}
